---
import { readFileSync } from 'fs';
import { join } from 'path';

// Read and parse the CSV file
const csvPath = join(process.cwd(), 'src/data/qiskit_fall_fest_2025_schedule.csv');
const csvContent = readFileSync(csvPath, 'utf-8');
const lines = csvContent.trim().split('\n');
const headers = lines[0].split(',');
const events = lines.slice(1).map(line => {
	const values = line.split(',');
	return {
		date: values[0],
		time: values[1],
		activity: values[2],
		category: values[3],
		mode: values[4]
	};
});

// Group events by category for better organization
const eventsByCategory = events.reduce((acc, event) => {
	if (!acc[event.category]) {
		acc[event.category] = [];
	}
	acc[event.category].push(event);
	return acc;
}, {} as Record<string, typeof events>);

// Category colors
const categoryColors = {
	'Kick-Off Event': 'bg-purple-500',
	'Pre-Event': 'bg-blue-500',
	'Intro and Online Workshop By IBM Quantum': 'bg-indigo-500',
	'Training Series': 'bg-green-500',
	'Hackathon': 'bg-red-500',
	'Closing Ceremony': 'bg-yellow-500'
};

const getModeIcon = (mode: string) => {
	switch (mode.toLowerCase()) {
		case 'online':
			return 'ğŸŒ';
		case 'hybrid':
			return 'ğŸ”„';
		case 'offline':
			return 'ğŸ¢';
		default:
			return 'ğŸ“…';
	}
};
---

<section id="schedule" class="py-20 bg-gray-50">
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
		<!-- Section Header -->
		<div class="text-center mb-16">
			<h2 class="text-4xl font-bold text-gray-900 mb-4">
				Event <span class="text-purple-600">Schedule</span>
			</h2>
			<p class="text-xl text-gray-600 max-w-3xl mx-auto">
				Join us for an exciting journey through quantum computing with workshops, training sessions, and hackathons spanning from September to November 2025.
			</p>
		</div>
		
		<!-- Timeline -->
		<div class="relative">
			<!-- Timeline line -->
			<div class="absolute left-1/2 transform -translate-x-1/2 w-1 bg-purple-200 h-full hidden lg:block"></div>
			
			<div class="space-y-12">
				{events.map((event, index) => {
					const isEven = index % 2 === 0;
					const categoryColor = categoryColors[event.category as keyof typeof categoryColors] || 'bg-gray-500';
					
					return (
						<div class={`relative flex items-center ${isEven ? 'lg:flex-row' : 'lg:flex-row-reverse'} flex-col lg:space-x-8`}>
							<!-- Timeline dot -->
							<div class="absolute left-1/2 transform -translate-x-1/2 w-4 h-4 bg-purple-600 rounded-full border-4 border-white shadow-lg z-10 hidden lg:block"></div>
							
							<!-- Event card -->
							<div class={`w-full lg:w-5/12 ${isEven ? 'lg:text-right lg:pr-8' : 'lg:text-left lg:pl-8'}`}>
								<div class="bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow duration-300">
									<!-- Date and time -->
									<div class="flex items-center justify-between mb-4">
										<div class="flex items-center space-x-2">
											<div class={`w-3 h-3 rounded-full ${categoryColor}`}></div>
											<span class="text-sm font-medium text-gray-500 uppercase tracking-wide">{event.category}</span>
										</div>
										<span class="text-2xl">{getModeIcon(event.mode)}</span>
									</div>
									
									<h3 class="text-xl font-bold text-gray-900 mb-2">{event.activity}</h3>
									
									<div class="space-y-2 text-sm text-gray-600">
										<div class="flex items-center space-x-2">
											<svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
												<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3a1 1 0 011-1h6a1 1 0 011 1v4h3a2 2 0 012 2v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2h3z" />
											</svg>
											<span class="font-medium">{event.date}</span>
										</div>
										{event.time !== '-' && (
											<div class="flex items-center space-x-2">
												<svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
													<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
												</svg>
												<span>{event.time}</span>
											</div>
										)}
										<div class="flex items-center space-x-2">
											<svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
												<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9" />
											</svg>
											<span class="capitalize">{event.mode}</span>
										</div>
									</div>
								</div>
							</div>
							
							<!-- Spacer for opposite side -->
							<div class="w-full lg:w-5/12 hidden lg:block"></div>
						</div>
					);
				})}
			</div>
		</div>
		
		<!-- Call to action -->
		<div class="text-center mt-16">
			<div class="bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg p-8 text-white">
				<h3 class="text-2xl font-bold mb-4">Ready to Join the Quantum Revolution?</h3>
				<p class="text-purple-100 mb-6">Don't miss out on this incredible opportunity to learn quantum computing with industry experts and fellow enthusiasts.</p>
				<a href="#register" class="bg-white text-purple-600 hover:bg-gray-100 font-bold py-3 px-8 rounded-lg transition-colors duration-300">
					Register Now
				</a>
			</div>
		</div>
	</div>
</section>